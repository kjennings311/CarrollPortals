
@{
    ViewBag.Title = "PayRoll Status Change Notice";
}

<div class="row wrapper border-bottom white-bg page-heading">
    <div class="col-lg-10">

        <ol class="breadcrumb" style="padding: 8px 15px;" >
            <li>
                <a href="~/Home/Index">Home</a>
            </li>
            <li class="active">
                <strong> PayRoll Status Change Notice </strong>
            </li>
        </ol>
    </div>

    <div class="col-lg-2">

    </div>
</div>

<div class="RowsContatiner animated fadeInRight">
    <div class="col-lg-12">
        <div class="ibox float-e-margins">
            <div class="ibox-content" style="margin-left:10%; padding-top:0px;width:80%">
                <form id="submitform" onsubmit="return false;">
                    <p class="c1 c8" style="margin-left:30%;">
                        <span class="c7">
                            <img src="~/img/newhirenotice.png">
                        </span>
                    </p>
                    <p class="c0 c5"><span class="c3"></span></p>
                    <p class="c0" style="margin-left: 12%;"><span class="c2">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c2 c7">PAYROLL STATUS CHANGE NOTICE</span></p>

                    <p class="c0"><span class="c1">Employee Name: <input type="text" id="empname" style="width:50%" />  Change effective as of: <input type="date" id="effectivedate" />  </span></p>
                    <p class="c0"><span class="c4">Manager Responsibilities: Complete the Payroll Status Change Notice, sign the form, and submit to Human Resources for any payroll/status adjustments. PLEASE NOTE pay changes need to have an effective date at the beginning of a pay period unless otherwise noted. Please send completed forms to HRNotifications@carrollmg.com.</span></p>
                    <p class="c0"><span class="c1">Manager:<input type="text" id="manager" style="width:55.5%; margin-right:5%" />  Today&rsquo;s Date:<input  type="date" id="todaydate" /> </span></p>
                    <p class="c0"><span class="c1">Client/Location:<input type="text" id="location" style="width:82%;" /> </span></p>
                    <p class="c0"><span class="c7 c8"> Check the boxes that apply and provide the explanation below: </span></p>
                    <p class="c0"><span class="c1">  <input type="checkbox" id="newhire" class="bs-checkbox" />  New Hire  <input type="checkbox" class="bs-checkbox" id="rehire" />  ReHire <input type="checkbox" id="transfer" class="bs-checkbox" />  Transfer Position<input type="text" style="width:25%" id="exempt" />  Exempt <input type="text" style="width:26.5%" id="nonexempt" />  Non-exempt </span></p>
                    <p class="c0"><span class="c1">Position<input style="width:87%;" type="text" id="position" /> </span></p>
                    <p class="c0"><span class="c1">SS#<input type="text" style="width:42%" id="sshash" /> DOB : <input type="date" id="dob" />  Status (full-time / part-time)<select id="status1"> <option value="Full Time"> Full Time </option><option value="Part Time"> Part Time </option> </select></span></p>
                    <p class="c0"><span class="c1">Wage/Salary<input type="text" style="width:40%" id="salary" /> Allocation<input type="text" style="width:37%" id="allocation" /> </span></p>
                    <p class="c0"><span class="c1">Street Address <input type="text" style="width:82%" id="streetaddress" /> </span></p>
                    <p class="c0"><span class="c1">City / State / Zip <input type="text" id="city_state_zip" style="width:80.5%" /> </span></p>
                    <p class="c0"><span class="c1">Phone (home, cell, work)<input type="tel" id="phone" style="width:75.5%" /> </span></p>
                    <p class="c0"><span class="c1">Change of Pay Rate From $<input type="number" id="payratefrom" style="width:30%" />  to $<input style="width:30%" type="number" id="payrateto" /> </span></p>
                    <p class="c0"><span class="c1">Change of Position/Property From<input type="text" id="propertyfrom" style="width:30%" />  To <input  style="width:26%" type="text" id="propertyto" /> </span></p>
                    <p class="c0"><span class="c1">Change of Address, Emergency Contact Information or Updated Employee Info</span></p>
                    <p class="c0"><span class="c1"><input type="text" id="address_emergency1" style="width:91%" /> </span></p>
                    <p class="c0"><span class="c1"><input type="text" id="address_emergency2" style="width:91%" /> </span></p>
                    <p class="c0"><span class="c1">Disciplinary Suspension Date(s) of Suspension <input style="width:21%" type="text" id="suspensiondate" /> <input type="text" id="suspension_paid" />Paid<input type="text" id="suspension_unpaid" /> Unpaid</span></p>
                    <p class="c0"><span class="c1">Leave of Absence Date(s) of Leave<input type="text" style="width:28%" id="leavedate" /> <input type="number" id="leave_paid" /> Paid <input type="number" id="leave_unpaid" /> Unpaid </span></p>
                    <p class="c0" style="width:91%"><span class="c1">Explanation: Please include other relevant information below for the record if it was discussed with the employee (proposed increase, date for next performance review, on-call arrangement, benefits or non-standard benefits, special circumstances, etc.) <input type="text" style="width:91%" id="explanation1" /></span></p>
                    <p class="c0"><span class="c1"><input type="text" id="explanation2" style="width:91%" /></span></p>
                    <p class="c0"><span class="c1">Employee Signature ____________________________________________ Date ______________</span></p>
                    <p class="c0"><span class="c1">Manager&rsquo;s Signature____________________________________________ Date______________</span></p>
                    <p class="c0"><span class="c1">Executive or Regional Manager Signature____________________________ Date______________</span></p>

                    <br /> <br />
                    <div id="status"> </div>
                    <div class="col-md-12" style="text-align:center;margin-bottom:20px;">

                        <input type="button" id="Submit" value="Submit" class="btn btn-primary" />  <button class="btn btn-success" disabled id="print"> <i class="fa-print fa"> </i> Print </button> <button disabled class="btn btn-success" id="pdf"> <i class="fa-file-pdf-o fa"> </i> Pdf </button>

                    </div>
                </form>

            </div>
        </div>
    </div>

</div>




@if (ViewBag.ErrorMessage == "AuthorizationRequired")
{
    <p>You have to sign-in to see your to do list. Click @Html.ActionLink("here", "Index", "Form", new { reauth = true }, null) to sign-in.</p>

}
@if (ViewBag.ErrorMessage == "UnexpectedError")
{
    <p>An unexpected error occurred while retrieving your to do list.  Please try again.  You may need to sign-in.</p>
}
@section Styles {
    @Styles.Render("~/content/plugins/dataTables/dataTablesStylescss")
    @Styles.Render("~/content/plugins/token-inputcss")
    <style type="text/css">
        @@import url('https://themes.googleusercontent.com/fonts/css?kit=7ebMze0MJP7bZu91CQ7uEDTuLqYM6x6ICRZT_kL-IXY');

        ol {
            margin: 0;
            padding: 0
        }

        table td, table th {
            padding: 0
        }

        .c3 {
            color: #000000;
            font-weight: 400;
            text-decoration: none;
            vertical-align: baseline;
            font-size: 12pt;
            font-family: "Times";
            font-style: normal
        }

        .c1 {
            color: #000000;
            font-weight: 400;
            text-decoration: none;
            vertical-align: baseline;
            font-size: 11pt;
            font-family: "Times";
            font-style: normal
        }

        .c4 {
            color: #000000;
            font-weight: 400;
            text-decoration: none;
            vertical-align: baseline;
            font-size: 11pt;
            font-family: "Times";
            font-style: italic
        }

        .c0 {
            padding-top: 0pt;
            padding-bottom: 5pt;
            line-height: 1.15;
            text-align: left
        }

        .c7 {
            color: #000000;
            text-decoration: none;
            vertical-align: baseline;
            font-style: normal
        }

        .c6 {
            background-color: #ffffff;
            max-width: 468pt;
            padding: 72pt 72pt 72pt 72pt
        }

        .c2 {
            font-size: 14pt;
            font-family: "Times";
            font-weight: 700
        }

        .c8 {
            font-weight: 700;
            font-size: 11pt;
            font-family: "Times"
        }

        .c5 {
            height: 11pt
        }

        .title {
            padding-top: 24pt;
            color: #000000;
            font-weight: 700;
            font-size: 36pt;
            padding-bottom: 6pt;
            font-family: "Arial";
            line-height: 1.15;
            page-break-after: avoid;
            orphans: 2;
            widows: 2;
            text-align: left
        }

        .subtitle {
            padding-top: 18pt;
            color: #666666;
            font-size: 24pt;
            padding-bottom: 4pt;
            font-family: "Georgia";
            line-height: 1.15;
            page-break-after: avoid;
            font-style: italic;
            orphans: 2;
            widows: 2;
            text-align: left
        }

        /*li {
            color: #000000;
            font-size: 11pt;
            font-family: "Arial"
        }*/

        p {
            margin: 0;
            color: #000000;
            font-size: 11pt;
            font-family: "Arial"
        }

        h1 {
            padding-top: 24pt;
            color: #000000;
            font-weight: 700;
            font-size: 24pt;
            padding-bottom: 6pt;
            font-family: "Arial";
            line-height: 1.15;
            page-break-after: avoid;
            orphans: 2;
            widows: 2;
            text-align: left
        }

        h2 {
            padding-top: 18pt;
            color: #000000;
            font-weight: 700;
            font-size: 18pt;
            padding-bottom: 4pt;
            font-family: "Arial";
            line-height: 1.15;
            page-break-after: avoid;
            orphans: 2;
            widows: 2;
            text-align: left
        }

        h3 {
            padding-top: 14pt;
            color: #000000;
            font-weight: 700;
            font-size: 14pt;
            padding-bottom: 4pt;
            font-family: "Arial";
            line-height: 1.15;
            page-break-after: avoid;
            orphans: 2;
            widows: 2;
            text-align: left
        }

        h4 {
            padding-top: 12pt;
            color: #000000;
            font-weight: 700;
            font-size: 12pt;
            padding-bottom: 2pt;
            font-family: "Arial";
            line-height: 1.15;
            page-break-after: avoid;
            orphans: 2;
            widows: 2;
            text-align: left
        }

        h5 {
            padding-top: 11pt;
            color: #000000;
            font-weight: 700;
            font-size: 11pt;
            padding-bottom: 2pt;
            font-family: "Arial";
            line-height: 1.15;
            page-break-after: avoid;
            orphans: 2;
            widows: 2;
            text-align: left
        }

        h6 {
            padding-top: 10pt;
            color: #000000;
            font-weight: 700;
            font-size: 10pt;
            padding-bottom: 2pt;
            font-family: "Arial";
            line-height: 1.15;
            page-break-after: avoid;
            orphans: 2;
            widows: 2;
            text-align: left
        }

        input {
            border: none;
            border-bottom: 1px solid #0c0606;
            padding: 5px;
        }

        button {
            margin-left: 4%;
        }

        .has-error {
            border-color: red;
        }
    </style>
}

@section Scripts
{
    @Scripts.Render("~/scripts/plugins/dataTablesjs")
    @Scripts.Render("~/scripts/plugins/input-maskjs")
    @Scripts.Render("~/scripts/plugins/token-inputjs")

    <script>

        $(document).ready(function () {
            var leaseid = "";

            $("input").change(function (e)
            {
                e.preventDefault();

                if ($(this).val() == "") {
                    $(this).addClass("has-error");
                }
                else {
                    $(this).removeClass("has-error");
                }

            });


            $("#Submit").click(function (e)
            {

                e.preventDefault();

                var errormsgsummary = "";
                var control = "";
                $("#status").html('');

                if ($("#empname").val() == "")
                {
                    errormsgsummary += "<li> Please Enter Employee Name </li>";
                    $("#empname").addClass('has-error');
                    if (control == "")
                        control = $("#empname");
                }

                if ($("#effectivedate").val() == "")
                {
                    errormsgsummary += "<li> Please Enter Effective Date </li>";
                    $("#effectivedate").addClass('has-error');
                    if (control == "")
                        control = $("#effectivedate");
                }

                if ($("#manager").val() == "")
                {
                    errormsgsummary += "<li> Please Enter Manager </li>";
                    $("#manager").addClass('has-error');
                    if (control == "")
                        control = $("#manager");
                }

                if ($("#todaydate").val() == "")
                {
                    errormsgsummary += "<li> Please Enter Today's Date </li>";
                    $("#todaydate").addClass('has-error');
                    if (control == "")
                        control = $("#todaydate");
                }

                if ($("#location").val() == "") {
                    errormsgsummary += "<li> Please Enter Location </li>";
                    $("#location").addClass('has-error');
                    if (control == "")
                        control = $("#location");
                }


                if ($("#position").val() == "")
                {
                    errormsgsummary += "<li> Please Enter Position Of Employee </li>";
                    $("#position").addClass('has-error');
                    if (control == "")
                        control = $("#position");
                }

                if ($("#dob").val() == "")
                {
                    errormsgsummary += "<li> Please Enter Date Of Birth </li>";
                    $("#dob").addClass('has-error');
                    if (control == "")
                        control = $("#dob");
                }


                if ($("#status1").val() == "")
                {
                    errormsgsummary += "<li> Please Choose Status  </li>";
                    $("#status1").addClass('has-error');
                    if (control == "")
                        control = $("#status1");
                }


                if ($("#salary").val() == "")
                {
                    errormsgsummary += "<li> Please Enter Salary/Wage  </li>";
                    $("#salary").addClass('has-error');
                    if (control == "")
                        control = $("#salary");
                }

                if ($("#allocation").val() == "")
                {
                    errormsgsummary += "<li> Please Enter Allocation  </li>";
                    $("#allocation").addClass('has-error');
                    if (control == "")
                        control = $("#allocation");
                }


                if ($("#streetaddress").val() == "")
                {
                    errormsgsummary += "<li> Please Enter Street Address  </li>";
                    $("#streetaddress").addClass('has-error');
                    if (control == "")
                        control = $("#streetaddress");
                }


                if ($("#city_state_zip").val() == "") {
                    errormsgsummary += "<li> Please Enter City/State/Zip  </li>";
                    $("#city_state_zip").addClass('has-error');
                    if (control == "")
                        control = $("#city_state_zip");
                }


                if ($("#phone").val() == "")
                {
                    errormsgsummary += "<li> Please Enter Mobile/Phone Number </li>";
                        $("#phone").addClass('has-error');
                    if (control == "")
                        control = $("#phone");
                }
                
                if (errormsgsummary != "")
                {

                    $("#status").html('<ul style="float: left;text-align:left;color: red;"> ' + errormsgsummary + ' </ul> ');

                    setTimeout(ScrollToElement(control), 3000);
                    $("#Submit").prop('disabled', false);
                    return false;
                }
                else
                {

                    var insertForm = new FormData();
                    insertForm.append('empname', $("#empname").val());
                    insertForm.append('effectivedate', $("#effectivedate").val());
                    insertForm.append('manager', $("#manager").val());
                    insertForm.append('todaydate', $("#todaydate").val());
                  
                    insertForm.append('location', $("#location").val());
                    insertForm.append('position', $("#position").val());
               
                    insertForm.append('newhire', $("#newhire").is(":checked"));
                    insertForm.append('rehire', $("#rehire").is(":checked"));
                    insertForm.append('transfer', $("#transfer").is(":checked"));
                    insertForm.append('ss', $("#sshash").val());
                    insertForm.append('dob', $("#dob").val());
                    insertForm.append('exempt', $("#exempt").val());
                    insertForm.append('nonexempt', $("#nonexempt").val());
                    insertForm.append('streetaddress', $("#streetaddress").val());
                    insertForm.append('city_state_zip', $("#city_state_zip").val());
                    insertForm.append('phone', $("#phone").val());
                    insertForm.append('payratefrom', $("#payratefrom").val());
                    insertForm.append('payrateto', $("#payrateto").val());
                    insertForm.append('propertyfrom', $("#propertyfrom").val());
                    insertForm.append('propertyto', $("#propertyto").val());
                    insertForm.append('address_contactinfo', $("#address_emergency1").val() + " " + $("#address_emergency2").val());
                    insertForm.append('dateofsuspence', $("#suspensiondate").val());
                    insertForm.append('suspence_paid', $("#suspension_paid").val());
                    insertForm.append('suspence_unpaid', $("#suspension_unpaid").val());

                    insertForm.append('leaveabsence', $("#leavedate").val());
                    insertForm.append('leave_paid', $("#leave_paid").val());
                    insertForm.append('leave_unpaid', $("#leave_unpaid").val());
                    insertForm.append('explanation', $("#explanation1").val()+" "+$("#explanation2").val());

                    insertForm.append('status', $("#status1").val());
                    insertForm.append('salary', $("#salary").val());
                    insertForm.append('allocation', $("#allocation").val());
                    insertForm.append('CreatedBy', $("#CreatedBy").val());
                    insertForm.append('CreatedByName', $("#CreatedByName").val());

                    $("#status").html("<p style='color:green'> Processing ........ </p>");

                    $.ajax({
                        url: $BaseApiUrl + "api/data/InsertPayRollStatusChangeNotice",
                        type: 'POST',
                        dataType: "JSON",
                        processData: false,
                        contentType: false,
                        data: insertForm,
                        success: function (data) {
                            // To-do code if ajax request is successful

                            if (data['error'] == false) {
                                leaseid = data['insertedId'];

                                $("#status").html("<p style='color:green'> Updated Sucessfully. </p>");

                                //    $("#submitform").trigger('reset');
                                //$("#submitform input") .each(function () {
                                //    this.reset();
                                //});

                                setTimeout(function () {

                                    $("#print").attr('disabled', false);
                                    $("#pdf").attr('disabled', false);
                                    $("#Submit").attr('disabled', true);
                                }, 1000);
                            }
                            else {
                                $("#status").html(data['errorMsg']);

                            }


                        },
                        error: function (ts) {
                            alert('error' + ts.errorMessage);
                        }
                    });

                }


            });

            $("#print").click(function (e) {
                e.preventDefault();
                if (leaseid != "") {

                    var printWindow = window.open("/Hr/PrintPayRollStatusChange/?id=" + leaseid, 'Employeee Lease Rider', 'left=20, top=20, width=950, height=auto, toolbar=0, resizable=0');
                    printWindow.addEventListener('load', function () {
                        setTimeout(function () {
                            printWindow.print();
                            //printWindow.close(); Notification.success({ message: "PDF Downloaded .....", delay: 3000 });
                        }, 1000);
                    }, true);
                }
            });


            $("#pdf").click(function (e) {
                e.preventDefault();
                if (leaseid != "") {
                    var printWindow = window.open("/Hr/PdfPayRollStatusChange/?id=" + leaseid, "Employee Lease Rider", 'left=20, top=20, width=950, height=auto, toolbar=0, resizable=0');
                    printWindow.addEventListener('load', function () {
                        setTimeout(function () {
                            printWindow.close();
                        }, 2000);
                    }, true);

                }

            });


        });

    </script>

}
